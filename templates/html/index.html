{% extends "base.html" %}

{% block css %}
<script src="static/js/jquery.js"></script>
<script src="static/js/Chart.bundle.min.js"></script>
<script src="static/js/moment.js"></script>
{% end %}

{% block header %}
<header class="intro-header" style="background-image: url('static/img/home-bg.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="site-heading">
                    <h2>Share Your Experience</h2>
                    <hr class="small">
                    <span id='description' class="subheading">A Way to keep track of the Cisco Intern Journey</span><br>
                </div>
            </div>
        </div>
    </div>
</header>
{% end %}


<!-- Main Content -->
{% block content %}
<div class="row">
  <div id="chart" class="col-lg-8 col-lg-offset-2">
    <canvas id="feelings-chart" height="160"></canvas>
  </div>
</div>

<div class="row">
    <div id='results' class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
    </div>
</div>

<script>
    var feelingsData = [];
    var labelsData = [];
    var bgColorData = [];
    var brdrColorData = [];

    $.ajax({
        type:"GET",
        url:"/top"
    }).complete(function(o){
        j = o.responseText;
        console.log(j);
        obj = JSON.parse(j);
        $("#results").html("");
        for (var i = 0; i < obj.length; i++) {
            feelingsData.push(obj[i].feeling);
            labelsData.push(i);
            bgColorData.push("rgba(255, 99, 132, 0.2)");
            brdrColorData.push("rgba(255, 206, 86, 1)");
        }
        createChart(feelingsData, labelsData);
    });


    function createChart(feelingsData, labelsData) {
      var ctx = document.getElementById("feelings-chart");
      var myChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: labelsData,
          datasets: [{
            label: "Intern Feelings Over Time",
            data: feelingsData,
            backgroundColor: "rgba(255, 99, 132, 0.2)",
            borderColor: "rgba(255, 206, 86, 1)",
            borderWidth: 1
          }]
        },
        options: {
          scales: {
            yAxes: [{
              ticks: {
                beginAtZero:true
              }
            }]
          },
          responsive:true
        }
      });
  }
</script>
{% end %}
